(this.webpackJsonpfabricjs101=this.webpackJsonpfabricjs101||[]).push([[0],{21:function(t,e,n){t.exports=n(50)},30:function(t,e){},31:function(t,e){},32:function(t,e){},36:function(t,e,n){},50:function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),a=n(15),i=n.n(a),c=n(3),l=n.n(c),u=n(11),s=n(6),f=n(10),g=n(5),d=n(12),h=n(2),m=n(7),b=n.n(m),p=(n(36),n(9)),v=n(16),w=n.n(v),x=n(17),R=n.n(x),j=n(18),y=n(19),O=n.n(y),C=n(4),E=n(20),k=o.a.memo(o.a.forwardRef((function(t,e){return console.log("rerendering"),o.a.createElement("canvas",{ref:e,style:{border:"1px solid red"}})}))),A=function(t){var e=t.target;e.currentHeight>e.canvas.height||e.currentWidth>e.canvas.width||(e.setCoords(),(e.getBoundingRect().top<0||e.getBoundingRect().left<0)&&(e.top=Math.max(e.top,e.top-e.getBoundingRect().top),e.left=Math.max(e.left,e.left-e.getBoundingRect().left)),(e.getBoundingRect().top+e.getBoundingRect().height>e.canvas.height||e.getBoundingRect().left+e.getBoundingRect().width>e.canvas.width)&&(e.top=Math.min(e.top,e.canvas.height-e.getBoundingRect().height+e.top-e.getBoundingRect().top),e.left=Math.min(e.left,e.canvas.width-e.getBoundingRect().width+e.left-e.getBoundingRect().left)))},S=0,B=0,z=0,P=0,T=0,F=0,M=function(t){var e=t.target;e.setCoords();var n=e.getBoundingRect();n.width+n.left>=e.canvas.width||n.height+n.top>=e.canvas.height||n.left<0||n.top<0?(e.left=S,e.top=B,e.scaleX=z,e.scaleY=P,e.width=T,e.height=F):(S=e.left,B=e.top,z=e.scaleX,P=e.scaleY,T=e.width,F=e.height)},W=function(t,e){return t.left+t.width/2>e/2?{absolutePosition:{x:I(t.left,t.width,842),y:t.top-2},alignment:"center"}:{relativePosition:{x:0,y:t.top-2},margin:L(t.left,t.width,842),alignment:"center"}},H=function(t,e){return"left"===t.textAlign?{absolutePosition:{x:t.left,y:t.top-2},alignment:"left"}:{relativePosition:{x:0,y:t.top-2},alignment:"right",margin:[0,0,e-(t.left+t.width),0]}};function I(t,e,n){var r=t+e/2;return r>n/2?r-(n-r):0}function L(t,e,n){var r=t+e/2;return r<n/2?[0,0,n-2*r,0]:[0,0,0,0]}b.a.vfs=O.a.pdfMake.vfs;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement((function(){var t=Object(r.useRef)(null),e=Object(r.useRef)(null),n=Object(r.useRef)(null),a=Object(r.useRef)(null),i=Object(r.useState)(16),c=Object(d.a)(i,2),m=c[0],v=c[1],x=Object(r.useState)(16),y=Object(d.a)(x,2),O=y[0],S=y[1];Object(r.useEffect)((function(){var t;n.current=R()(e.current,(t={minDimensions:[10,20],defaultColWidth:100,tableOverflow:!0,tableWidth:"842px",tableHeight:"500px"},Object(g.a)(t,"minDimensions",[2,5]),Object(g.a)(t,"columns",[{title:"Column 1"},{title:"Column 2"}]),t))}),[]),Object(r.useEffect)((function(){a.current=new h.fabric.Canvas(t.current,{objectCaching:!1,preserveObjectStacking:!0,fontSize:20}),a.current.on("object:moving",A),a.current.on("selection:created",(function(t){t.target.fontSize&&v(parseInt(t.target.fontSize))})),a.current.on("object:scaling",M),a.current.setHeight(595),a.current.setWidth(842),a.current.renderAll(),console.log(h.fabric),h.fabric.Object.prototype.set({transparentCorners:!1,cornerColor:"#00FFFF",cornerStrokeColor:"red",borderColor:"red",cornerSize:12,padding:0,cornerStyle:"circle",borderDashArray:[3,3],hasControls:!1,hasRotatingPoint:!1});var e=new h.fabric.Text("Column 1",{left:0,fontSize:30,textAlign:"center",hasRotatingPoint:!1,top:0,fontFamily:"Roboto"}),n=new h.fabric.Text("Column 2",{left:0,fontSize:30,textAlign:"center",hasRotatingPoint:!1,top:0,fontFamily:"Roboto"}),r=new h.fabric.IText("m",{left:0,top:0,fontFamily:"Roboto"}),o=new h.fabric.Textbox("Lorem ipsum dibus repellat iusto Lorem ipsum dibus repellat iusto Lorem ipsum dibus repellat iusto Lorem ipsum dibus repellat iusto.",{width:200,top:400,hasControls:!0,left:200,fontSize:16,padding:0,textAlign:"center",fontFamily:"Roboto"});o.setControlsVisibility({mt:!1,mb:!1,ml:!0,mr:!0,bl:!1,br:!1,tl:!1,tr:!1,mtr:!1}),h.fabric.Image.fromURL("/certificate2.jpg",(function(t){console.log(t);a.current.setBackgroundImage(t,a.current.renderAll.bind(a.current),{scaleX:a.current.width/t.width,scaleY:a.current.height/t.height});console.log(t)})),a.current.add(r,n,e,o)}),[]);var B=function(){var t=Object(f.a)(l.a.mark((function t(){var e,r,o,i,c,f,g,d,h,m,p,v,x;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return x=function(t,e){for(var n=[],r=0;r<t.length;r++)n.push(Object(s.a)({},t[r],{text:e[t[r].text]}));return console.log(n),n},t.next=3,fetch("http://localhost:3000/certificate2.jpg").then((function(t){return t.blob()})).then((function(t){return new Promise((function(e,n){var r=new FileReader;r.onloadend=function(){return e(r.result)},r.onerror=n,r.readAsDataURL(t)}))}));case 3:for(e=t.sent,r={image:e,width:842,height:595,absolutePosition:{x:0,y:0}},o=a.current.toObject(),i=n.current.getHeaders().split(","),c=n.current.getData().filter((function(t){return t.some((function(t){return t}))})),f=[],g=[],d=o.objects,h=0;h<d.length;h++)"i-text"===d[h].type&&f.push({text:d[h].text,absolutePosition:{x:d[h].left,y:d[h].top-2},fontSize:d[h].fontSize,alignment:d[h].textAlign}),"image"===d[h].type&&f.push({image:d[h].src,absolutePosition:{x:d[h].left,y:d[h].top-2},width:d[h].width*d[h].scaleX,height:d[h].height*d[h].scaleY}),"textbox"===d[h].type&&f.push({text:d[h].text,relativePosition:{x:d[h].left,y:d[h].top-2},fontSize:d[h].fontSize,alignment:d[h].textAlign,margin:(d[h].left,l=d[h].width,R=842,[0,0,R-l,0])}),"text"===d[h].type&&g.push(Object(s.a)({text:i.indexOf(d[h].text)},"center"===d[h].textAlign?W(d[h],842):H(d[h],842),{fontSize:d[h].fontSize}));if(m=[],console.log(!c.length||!g.length),c.length&&g.length)for(p=0;p<c.length;p++)m=[].concat(Object(u.a)(m),[r,Object(s.a)({style:{bold:!0,italic:!0},stack:[].concat(f,Object(u.a)(x(g,c[p]))),unbreakable:!0},p!==c.length-1&&{pageBreak:"after"})]);else m=[r,{stack:[].concat(f),unbreakable:!0}];b.a.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}},v=w()({pageOrientation:"landscape",pageMargins:0,content:m}),b.a.createPdf(v).open();case 18:case"end":return t.stop()}var l,R}),t)})));return function(){return t.apply(this,arguments)}}(),z=function(t,e){var n=a.current.getActiveObject();n&&(n.set("textAlign",t),a.current.requestRenderAll())},P=function(){var e=Object(f.a)(l.a.mark((function e(n){var r,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={quality:.4,maxWidth:t.current.width/2,maxHeight:t.current.height/2,mimeType:n.target.files[0].type},n.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Object(p.readAndCompressImage)(n.target.files[0],r);case 5:o=e.sent,(i=new FileReader).onload=function(){var e=document.createElement("img");e.src=i.result,e.onload=function(){var n=new h.fabric.Image(e,{angle:0,opacity:1,cornerSize:12,hasControls:!0});t.current.width>t.current.height?(n.scaleToWidth(t.current.width-200),n.scaleToHeight(t.current.height-200)):(n.scaleToHeight(t.current.height-200),n.scaleToWidth(t.current.width-200)),a.current.add(n),a.current.centerObject(n)}},i.readAsDataURL(o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement("div",{style:{display:"flex"}},o.a.createElement(j.a,null),o.a.createElement("div",null,o.a.createElement(k,{ref:t}),o.a.createElement("div",null,o.a.createElement("button",{"data-tip":"Text Align Left",onClick:function(){return z("left")}},o.a.createElement(C.b,null)),o.a.createElement("button",{"data-tip":"Text Align Center",onClick:function(){return z("center")}},o.a.createElement(C.a,null)),o.a.createElement("button",{"data-tip":"Text Align Right",onClick:function(){return z("right")}},o.a.createElement(C.c,null))),o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){var t=a.current.getActiveObject();t?console.log(t.toObject()):console.log(a.current.toObject())}},"LOG JSON"),o.a.createElement("button",{onClick:B},"download"),o.a.createElement("button",{"data-tip":"Center Horizontally",onClick:function(){var t=a.current.getActiveObject();t&&t.type&&(t.set({left:a.current.getWidth()/2-t.width/2}),t.setCoords(),a.current.requestRenderAll())}},o.a.createElement(E.a,null)),o.a.createElement("button",{"data-tip":"Move Up",onClick:function(){var t=a.current.getActiveObject();t&&t.type&&(a.current.bringForward(t),a.current.requestRenderAll())}},o.a.createElement(C.e,null)),o.a.createElement("button",{"data-tip":"Move Down",onClick:function(){var t=a.current.getActiveObject();t&&t.type&&(a.current.sendBackwards(t),a.current.requestRenderAll())}},o.a.createElement(C.d,null)),o.a.createElement("button",{onClick:function(){S(O+1)}},"state change"),o.a.createElement("button",{onClick:function(t){var e=a.current.getActiveObject();e&&a.current.remove(e)}},"X")),o.a.createElement("input",{type:"file",id:"file",onChange:P,accept:"image/*"}),o.a.createElement("input",{type:"number",name:"quantity",defaultValue:m,key:m,min:"10",max:"80",onChange:function(t){console.log(t.target.value);var e=a.current.getActiveObject();e&&(e.set("fontSize",t.target.value.toString()),a.current.requestRenderAll())}})),o.a.createElement("div",null,o.a.createElement("div",{ref:e}),o.a.createElement("button",{onClick:function(){console.log(n.current.getHeaders().split(",")),console.log(n.current.getData())}},"log data")))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[21,1,2]]]);
//# sourceMappingURL=main.b309bcaf.chunk.js.map